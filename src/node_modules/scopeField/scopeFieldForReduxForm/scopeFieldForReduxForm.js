import { Children } from 'react';
import { connect } from 'react-redux';
import { change } from 'redux-form';

import ScopeField from '../ScopeFieldBase/ScopeFieldBase'

export const scopeFieldForReduxForm = () => {
  const mapDispatchToProps = (dispatch, ownProps) => ({
    resetFieldValue: () => {
      const child = Children.only(ownProps.children);
      dispatch(change(
        // this will work only if immediate parent of ScopeFieldForReduxForm is component wrapped with reduxForm HOC
        child._owner.memoizedProps.form,
        child.props.name.split('.')[0],
        ownProps.onReset ? ownProps.onReset() : '',
      ));
    },
  });

  return connect(null, mapDispatchToProps)(ScopeField);
};

export default scopeFieldForReduxForm()


